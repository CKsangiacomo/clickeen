---
import { pragueT } from '../../../lib/i18n';

type WidgetSubpage = 'overview' | 'templates' | 'examples' | 'features' | 'pricing';

type Props = {
  market: string;
  locale: string;
  widget: string;
  active: WidgetSubpage;
  /** page: full-width section (default). inline: render as an inline row (for hero). */
  variant?: 'page' | 'inline';
};

const { market, locale, widget, active, variant = 'page' } = Astro.props;

const overviewLabel = await pragueT(locale, 'prague.tabs.overview');
const templatesLabel = await pragueT(locale, 'prague.tabs.templates');
const examplesLabel = await pragueT(locale, 'prague.tabs.examples');
const featuresLabel = await pragueT(locale, 'prague.tabs.features');
const pricingLabel = await pragueT(locale, 'prague.tabs.pricing');

const tabs: { key: WidgetSubpage; label: string; href: string }[] = [
  { key: 'overview', label: overviewLabel, href: `/${market}/${locale}/widgets/${widget}/` },
  { key: 'templates', label: templatesLabel, href: `/${market}/${locale}/widgets/${widget}/templates/` },
  { key: 'examples', label: examplesLabel, href: `/${market}/${locale}/widgets/${widget}/examples/` },
  { key: 'features', label: featuresLabel, href: `/${market}/${locale}/widgets/${widget}/features/` },
  { key: 'pricing', label: pricingLabel, href: `/${market}/${locale}/widgets/${widget}/pricing/` },
];
---

{variant === 'inline' ? (
  <nav class="ck-row ck-widgetSubnav__row" aria-label="Widget sections">
    {tabs.map((t) => {
      const isActive = t.key === active;
      return (
        <a
          href={t.href}
          class={`label-s ck-widgetSubnav__tab${isActive ? ' is-active' : ''}`}
          aria-current={isActive ? 'page' : undefined}
        >
          {t.label}
        </a>
      );
    })}
  </nav>
) : (
  <section class="ck-canvas ck-widgetSubnav" aria-label="Widget sections">
    <div class="ck-inline">
      <div class="ck-row ck-widgetSubnav__row">
        {tabs.map((t) => {
          const isActive = t.key === active;
          return (
            <a
              href={t.href}
              class={`label-s ck-widgetSubnav__tab${isActive ? ' is-active' : ''}`}
              aria-current={isActive ? 'page' : undefined}
            >
              {t.label}
            </a>
          );
        })}
      </div>
    </div>
  </section>
)}

<style>
  /* Page-level secondary nav (never sticky): belongs to the widget page, not the global Nav. */
  .ck-widgetSubnav {
    padding-top: 0;
    padding-bottom: var(--space-6);
  }

  .ck-widgetSubnav__row {
    gap: var(--space-4);
  }

  .ck-widgetSubnav__tab {
    text-decoration: none;
    padding: 6px 10px;
    border-radius: var(--control-radius-md);
    color: color-mix(in oklab, var(--color-system-black), transparent 35%);
  }

  .ck-widgetSubnav__tab.is-active {
    color: var(--color-system-black);
    background: color-mix(in oklab, var(--color-system-black), transparent 92%);
  }
</style>
