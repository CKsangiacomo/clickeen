---
import {
  actionGroupFromLegacy,
  actionGroupToPrimitives,
  assertPrimitives,
  type ActionGroup,
} from '@clickeen/composition';
import PrimitiveRenderer from '@clickeen/composition/renderers/astro/PrimitiveRenderer.astro';

type Props = {
  headline: string;
  body: string;
  primaryCta: { label: string; href: string };
  secondaryCta?: { label: string; href: string };
  actionGroup?: ActionGroup;
};

const { headline, body, primaryCta, secondaryCta, actionGroup } = Astro.props;

const contentPrimitives = assertPrimitives(
  [
    {
      type: 'heading',
      level: 2,
      content: headline,
      className: 'display-2 ck-m0 ck-bigBang__title',
    },
    {
      type: 'text',
      variant: 'body',
      content: body,
      className: 'body-website-xlarge ck-m0 ck-bigBang__body',
    },
  ],
  'big-bang.content',
);

const resolvedActionGroup =
  actionGroup ??
  actionGroupFromLegacy(primaryCta, secondaryCta, {
    layout: 'row',
    className: 'ck-bigBang__ctaRow',
    primaryClassName: 'ck-btn--lg label-l',
    secondaryClassName: 'ck-btn--lg label-l',
  });
---

<section class="ck-canvas ck-bigBang">
  <div class="ck-inline ck-bigBang__inline">
    <div class="ck-stack ck-bigBang__content">
      <div class="ck-stack ck-bigBang__copy">
        <PrimitiveRenderer primitives={contentPrimitives} />
      </div>

      {resolvedActionGroup ? (
        <PrimitiveRenderer primitives={[actionGroupToPrimitives(resolvedActionGroup)]} />
      ) : null}
    </div>
  </div>
</section>

<style>
  .ck-bigBang {
    background: var(--color-system-brown-5);
  }

  /* BigBang wants a bigger page gutter than the Prague default. */
  .ck-bigBang__inline {
    padding-inline: var(--space-10);
    border-radius: var(--control-radius-4xl);
    overflow: hidden;
  }

  .ck-bigBang__content {
    gap: var(--space-8);
  }

  .ck-bigBang__copy {
    gap: var(--space-4);
  }

  .ck-bigBang__title {
  }

  .ck-bigBang__body {
  }

  .ck-bigBang__ctaRow {
    gap: var(--space-3);
  }

  @media (max-width: 900px) {
    .ck-bigBang__content {
      gap: var(--space-6);
    }
    .ck-bigBang__title {
      /* Keep display-1 but avoid extreme wrapping jitter on narrow viewports. */
      text-wrap: balance;
    }
  }
</style>
