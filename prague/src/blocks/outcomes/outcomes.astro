---
import { assertPrimitives } from '@clickeen/composition';
import PrimitiveRenderer from '@clickeen/composition/renderers/astro/PrimitiveRenderer.astro';

type Props = {
  title?: string;
  items: Array<{
    title: string;
    body: string;
    eyebrow?: string;
  }>;
};

const { title = 'Why this widget works', items } = Astro.props;

const headerPrimitives = title
  ? assertPrimitives(
      [
        {
          type: 'heading',
          level: 3,
          content: title,
          className: 'heading-3 ck-outcomes__title',
        },
      ],
      'outcomes.header',
    )
  : [];
---

<section class="ck-canvas ck-outcomes">
  <div class="ck-inline ck-stack ck-outcomes__inner">
    {title ? <PrimitiveRenderer primitives={headerPrimitives} /> : null}

    <div class="ck-outcomes__grid" role="list">
      {items.map((item) => (
        <article class="ck-card ck-outcomeCard" role="listitem">
          <div class="ck-stack ck-outcomeCard__inner">
            <PrimitiveRenderer
              primitives={assertPrimitives(
                [
                  ...(item.eyebrow
                    ? [
                        {
                          type: 'text',
                          variant: 'caption',
                          content: item.eyebrow,
                          className: 'caption ck-outcomeCard__eyebrow',
                        },
                      ]
                    : []),
                  {
                    type: 'text',
                    variant: 'label',
                    content: item.title,
                    className: 'label-l ck-outcomeCard__heading',
                  },
                  {
                    type: 'text',
                    variant: 'body',
                    content: item.body,
                    className: 'body-s ck-outcomeCard__body ck-text-subtle',
                  },
                ],
                'outcomes.items',
              )}
            />
          </div>
        </article>
      ))}
    </div>
  </div>
</section>

<style>
  .ck-outcomes { }
  .ck-outcomes__inner { gap: var(--space-5); }
  .ck-outcomes__title { margin: 0; }

  /* Use a real grid (not flex wrap) so card rhythm is deterministic. */
  .ck-outcomes__grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: var(--space-4);
    align-items: stretch;
  }

  .ck-outcomeCard {
    min-height: 140px;
  }

  .ck-outcomeCard__inner {
    padding: var(--space-6);
    gap: var(--space-2);
  }

  .ck-outcomeCard__eyebrow {
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: color-mix(in oklab, var(--color-system-black), transparent 52%);
  }

  .ck-outcomeCard__heading { }
  .ck-outcomeCard__body { margin: 0; }

  @media (max-width: 900px) {
    .ck-outcomes__grid {
      grid-template-columns: 1fr;
    }
    .ck-outcomeCard__inner {
      padding: var(--space-5);
    }
  }
</style>
