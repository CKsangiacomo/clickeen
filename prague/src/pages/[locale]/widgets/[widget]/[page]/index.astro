---
import Base from '../../../../../layouts/Base.astro';
import Nav from '../../../../../blocks/site/nav/Nav.astro';
import Footer from '../../../../../blocks/site/footer.astro';
import { listWidgets, listWidgetPages } from '../../../../../lib/markdown';
import { listPragueLocales } from '../../../../../lib/locales';
import { pragueT } from '../../../../../lib/i18n';

const { locale, widget, page } = Astro.params;

export async function getStaticPaths() {
  const widgets = await listWidgets();
  const locales = listPragueLocales();
  const out: { params: { locale: string; widget: string; page: string } }[] = [];

  for (const w of widgets) {
    const pages = await listWidgetPages(w);
    for (const l of locales) {
      for (const p of pages) out.push({ params: { locale: l, widget: w, page: p } });
    }
  }

  return out;
}

function titleCase(s: string) {
  if (!s) return s;
  return s.slice(0, 1).toUpperCase() + s.slice(1);
}

const widgetLabel = titleCase(widget);
const pageLabel = titleCase(page);
---

<Base title={`${widgetLabel} — ${pageLabel} — Clickeen`} locale={locale}>
  <main>
    <Nav
      title="Clickeen"
      locale={locale}
      homeHref={`/${locale}/`}
      cta={{ label: pragueT(locale, 'prague.cta.createFree'), href: `/${locale}/create`, variant: 'primary' }}
    />

    <section class="ck-canvas ck-widgetSubpage">
      <div class="ck-inline ck-stack ck-widgetSubpage__inner">
        <h1 class="heading-2 ck-widgetSubpage__title">{widgetLabel} — {pageLabel}</h1>
        <p class="body-xxl ck-widgetSubpage__body">{pragueT(locale, 'prague.common.comingSoon')}</p>
      </div>
    </section>

    <Footer locale={locale} />
  </main>
</Base>

<style>
  .ck-widgetSubpage { padding-top: 0; }
  .ck-widgetSubpage__inner { gap: var(--space-3); }
  .ck-widgetSubpage__title { margin: 0; }
  .ck-widgetSubpage__body {
    margin: 0;
    color: color-mix(in oklab, var(--color-system-black), transparent 56%);
  }
</style>
