/* Dieter Button v2 â€” tokenized control */
.diet-btn {
  --btn-bg: var(--color-surface);
  --btn-color: var(--color-text);
  --btn-border-color: transparent;
  --btn-border-width: 0px;
  --btn-hover-bg: color-mix(in oklab, var(--btn-bg), var(--btn-color) 6%);
  --btn-hover-color: var(--btn-color);
  --btn-hover-border-color: var(--btn-border-color);
  --btn-clicked-bg: color-mix(in oklab, var(--btn-bg), var(--btn-color) 14%);
  --btn-clicked-color: var(--btn-color);
  --btn-clicked-border-color: var(--btn-border-color);
  --btn-radius: var(--control-radius-md, 0.375rem);
  --btn-height: var(--control-size-lg, 1.75rem);
  /* Inline paddings driven by Dieter spacing scale (default ~md) */
  --btn-padding-inline-end: var(--space-2);
  --btn-padding-inline-start-text: var(--space-2);
  /* Icon+text uses same start padding as text (simplified model) */
  --btn-padding-inline-start-icon-text: var(--space-2);
  --btn-font-size: var(--fs-14, 0.875rem);
  --btn-font-weight: 400;
  --btn-icon-box: var(--control-icon-md, 1.25rem);
  /* Glyph size driven by global ratio token */
  --btn-icon-glyph: calc(var(--btn-icon-box) * var(--control-icon-glyph-ratio));
  --btn-icon-color: currentColor;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  /* Gap set per size blocks directly from global tokens */
  gap: var(--control-inline-gap-md);
  min-height: var(--btn-height);
  padding-inline-start: var(--btn-padding-inline-start-text);
  padding-inline-end: var(--btn-padding-inline-end);
  padding-block: 0;
  border-radius: var(--btn-radius);
  border: var(--btn-border-width) solid var(--btn-border-color);
  background: var(--btn-bg);
  color: var(--btn-color);
  font-family: var(--control-font-family, var(--font-ui));
  font-size: var(--btn-font-size);
  font-weight: var(--btn-font-weight);
  line-height: 1;
  letter-spacing: 0.01em;
  text-decoration: none;
  white-space: nowrap;
  cursor: pointer;
  transition:
    background-color 150ms ease,
    color 150ms ease,
    border-color 150ms ease,
    box-shadow 150ms ease,
    transform 150ms ease;
}

.diet-btn > * { pointer-events: none; }

@media (prefers-reduced-motion: reduce) {
  .diet-btn { transition: none; }
}

.diet-btn[data-size="xs"] {
  /* xs size: 16px rail */
  --btn-height: var(--control-size-xs, 1rem);
  --btn-padding-inline-end: var(--space-2);
  --btn-padding-inline-start-text: var(--space-2);
  --btn-padding-inline-start-icon-text: var(--space-2);
  --btn-radius: var(--control-radius-xs, 0.25rem);
  gap: var(--control-inline-gap-xs);
  --btn-font-size: var(--fs-12, 0.75rem);
  --btn-icon-box: var(--control-icon-xs, 0.75rem);
  /* XS override: glyph ratio from token */
  --btn-icon-glyph: calc(var(--btn-icon-box) * var(--control-icon-glyph-ratio-xs));
}

.diet-btn[data-size="sm"] {
  --btn-height: var(--control-size-sm, 1.25rem);
  --btn-padding-inline-end: var(--space-2);
  --btn-padding-inline-start-text: var(--space-2);
  --btn-padding-inline-start-icon-text: var(--space-2);
  --btn-radius: var(--control-radius-sm, 0.3125rem);
  gap: var(--control-inline-gap-sm);
  --btn-font-size: var(--fs-13, 0.8125rem);
  --btn-icon-box: var(--control-icon-sm, 1rem);
  /* sm: glyph ratio token */
  --btn-icon-glyph: calc(var(--btn-icon-box) * var(--control-icon-glyph-ratio-sm));
}

.diet-btn[data-size="md"] {
  --btn-height: var(--control-size-md, 1.5rem);
  --btn-padding-inline-end: var(--space-2);
  --btn-padding-inline-start-text: var(--space-2);
  --btn-padding-inline-start-icon-text: var(--space-2);
  --btn-radius: var(--control-radius-md, 0.375rem);
  gap: var(--control-inline-gap-md);
  --btn-font-size: var(--fs-14, 0.875rem);
  --btn-icon-box: var(--control-icon-md, 1.25rem);
  /* md: glyph ratio token */
  --btn-icon-glyph: calc(var(--btn-icon-box) * var(--control-icon-glyph-ratio-md));
}

.diet-btn[data-size="lg"] {
  --btn-height: var(--control-size-lg, 1.75rem);
  /* Normalize to spacing scale: lg uses space-3 */
  --btn-padding-inline-end: var(--space-3);
  --btn-padding-inline-start-text: var(--space-3);
  --btn-padding-inline-start-icon-text: var(--space-3);
  --btn-radius: var(--control-radius-lg, 0.4375rem);
  gap: var(--control-inline-gap-lg);
  --btn-font-size: var(--fs-15, 0.9375rem);
  --btn-icon-box: var(--control-icon-lg, 1.5rem);
  /* Use global 80% */
}

.diet-btn[data-size="xl"] {
  --btn-height: var(--control-size-xl, 2rem);
  /* Normalize to spacing scale: xl uses space-3 */
  --btn-padding-inline-end: var(--space-3);
  --btn-padding-inline-start-text: var(--space-3);
  --btn-padding-inline-start-icon-text: var(--space-3);
  --btn-radius: var(--control-radius-xl, 0.5rem);
  gap: var(--control-inline-gap-xl);
  --btn-font-size: var(--fs-15, 0.9375rem);
  --btn-icon-box: var(--control-icon-xl, 1.75rem);
  /* XL override via token */
  --btn-icon-glyph: calc(var(--btn-icon-box) * var(--control-icon-glyph-ratio-xl));
}

.diet-btn__icon {
  inline-size: var(--btn-icon-box);
  block-size: var(--btn-icon-box);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--btn-icon-color);
  flex: none;
}

.diet-btn__icon svg {
  inline-size: var(--btn-icon-glyph);
  block-size: var(--btn-icon-glyph);
  display: block;
}

.diet-btn__label {
  display: inline-flex;
  align-items: center;
  font: inherit;
  white-space: nowrap;
}

.diet-btn[data-type="text-only"] {
  gap: 0;
  padding-inline-start: var(--btn-padding-inline-start-text);
}

.diet-btn:not([data-type]) {
  padding-inline-start: var(--btn-padding-inline-start-text);
}

.diet-btn[data-type="icon-text"] {
  /* Normalize: use same left padding as text-only; icon-only remains square */
  padding-inline-start: var(--btn-padding-inline-start-text);
}

.diet-btn[data-type="icon-only"] {
  --btn-padding-inline-start-text: 0;
  --btn-padding-inline-start-icon-text: 0;
  --btn-padding-inline-end: 0;
  inline-size: var(--btn-height);
  block-size: var(--btn-height);
  min-height: var(--btn-height);
  padding: 0;
}

/* XS icon-only: ensure glyph is 97% of the square (height-based) */
.diet-btn[data-type="icon-only"][data-size="xs"] {
  --btn-icon-glyph: calc(var(--btn-height) * var(--control-icon-glyph-ratio-xs));
}

.diet-btn[data-type="icon-only"] .diet-btn__icon {
  inline-size: 100%;
  block-size: 100%;
}

.diet-btn:hover:not(:disabled):not([aria-disabled="true"]) {
  background: var(--btn-hover-bg);
  color: var(--btn-hover-color);
  border-color: var(--btn-hover-border-color);
}

.diet-btn:active:not(:disabled):not([aria-disabled="true"]) {
  background: var(--btn-clicked-bg);
  color: var(--btn-clicked-color);
  border-color: var(--btn-clicked-border-color);
  transform: translateY(1px);
}

.diet-btn[aria-pressed="true"] {
  background: var(--btn-clicked-bg);
  color: var(--btn-clicked-color);
  border-color: var(--btn-clicked-border-color);
}

.diet-btn:focus-visible {
  outline: none;
  box-shadow:
    0 0 0 var(--focus-ring-offset, 2px) var(--color-bg, #ffffff),
    0 0 0 calc(var(--focus-ring-offset, 2px) + var(--focus-ring-width, 2px)) var(--focus-ring-color, var(--color-accent));
}

.diet-btn:disabled,
.diet-btn[aria-disabled="true"] {
  opacity: 0.48;
  cursor: not-allowed;
}

/* Variants */
.diet-btn[data-variant="primary"] {
  --btn-bg: var(--color-system-blue, #0a84ff);
  --btn-color: var(--color-system-white, #ffffff);
  --btn-border-color: transparent;
  --btn-hover-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), #000000 22%);
  --btn-clicked-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), #000000 40%);
}

.diet-btn[data-variant="secondary"] {
  --btn-bg: color-mix(in oklab, var(--color-surface), var(--color-text) 6%);
  --btn-border-color: color-mix(in oklab, var(--color-border), transparent 35%);
  --btn-hover-bg: color-mix(in oklab, var(--btn-bg), var(--color-text) 8%);
  --btn-clicked-bg: color-mix(in oklab, var(--btn-bg), var(--color-text) 25%);
}

.diet-btn[data-variant="neutral"] {
  --btn-bg: transparent;
  --btn-border-color: transparent;
  --btn-hover-bg: color-mix(in oklab, var(--color-text), transparent 88%);
  --btn-clicked-bg: color-mix(in oklab, var(--color-text), transparent 75%);
}

.diet-btn[data-variant="line1"] {
  --btn-bg: transparent;
  --btn-color: var(--color-system-blue, #0a84ff);
  --btn-border-width: 1px;
  --btn-border-color: var(--color-system-blue, #0a84ff);
  --btn-hover-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), transparent 60%);
  --btn-clicked-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), transparent 30%);
}

.diet-btn[data-variant="line2"] {
  --btn-bg: transparent;
  --btn-color: #838386; /* Gray 2 contrast */
  --btn-border-width: 1px;
  --btn-border-color: #838386;
  --btn-hover-bg: color-mix(in oklab, #838386, transparent 75%);
  --btn-clicked-bg: color-mix(in oklab, #838386, transparent 55%);
}

/* Loading state */
.diet-btn[data-state="loading"] {
  position: relative;
  pointer-events: none;
}

.diet-btn[data-state="loading"]::after {
  content: "";
  inline-size: calc(var(--btn-icon-box) * 0.75);
  block-size: calc(var(--btn-icon-box) * 0.75);
  border: 2px solid color-mix(in oklab, var(--btn-color), transparent 60%);
  border-top-color: var(--btn-color);
  border-radius: 999px;
  animation: diet-btn-spin 0.8s linear infinite;
}

@keyframes diet-btn-spin {
  to { transform: rotate(360deg); }
}

/* Dark theme adjustments */
@media (prefers-color-scheme: dark) {
  .diet-btn {
    --btn-hover-bg: color-mix(in oklab, var(--btn-bg), var(--btn-color) 10%);
    --btn-clicked-bg: color-mix(in oklab, var(--btn-bg), var(--btn-color) 22%);
  }

  .diet-btn[data-variant="primary"],
  .diet-btn[data-variant="primary"] {
    --btn-color: var(--color-system-white, #f5f6f8);
    --btn-hover-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), #000000 22%);
    --btn-clicked-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), #000000 40%);
  }

  .diet-btn[data-variant="secondary"] {
    --btn-bg: color-mix(in oklab, var(--color-surface, #14161b), #000000 35%);
    --btn-border-color: color-mix(in oklab, var(--color-border), transparent 10%);
    --btn-hover-bg: color-mix(in oklab, var(--btn-bg), var(--color-system-white) 20%);
    --btn-clicked-bg: color-mix(in oklab, var(--btn-bg), var(--color-system-white) 40%);
  }

  .diet-btn[data-variant="neutral"] {
    --btn-hover-bg: color-mix(in oklab, var(--color-system-white, #f5f6f8), transparent 88%);
    --btn-clicked-bg: color-mix(in oklab, var(--color-system-white, #f5f6f8), transparent 70%);
  }

  .diet-btn[data-variant="line1"] {
    --btn-color: var(--color-system-blue, #0a84ff);
    --btn-border-color: var(--color-system-blue, #0a84ff);
    --btn-hover-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), transparent 68%);
    --btn-clicked-bg: color-mix(in oklab, var(--color-system-blue, #0a84ff), transparent 46%);
  }

  .diet-btn[data-variant="line2"] {
    --btn-color: #8a8a8c; /* Gray 2 contrast dark */
    --btn-border-color: #8a8a8c;
    --btn-hover-bg: color-mix(in oklab, #8a8a8c, transparent 68%);
    --btn-clicked-bg: color-mix(in oklab, #8a8a8c, transparent 46%);
  }
}
