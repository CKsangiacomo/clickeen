name = "tokyo-assets-dev"
main = "src/index.ts"
compatibility_date = "2025-12-28"
workers_dev = true
routes = [
  { pattern = "tokyo.dev.clickeen.com/l10n/*", zone_name = "clickeen.com" },
  { pattern = "tokyo.dev.clickeen.com/assets/*", zone_name = "clickeen.com" },
  { pattern = "tokyo.dev.clickeen.com/fonts/*", zone_name = "clickeen.com" },
  { pattern = "tokyo.dev.clickeen.com/renders/*", zone_name = "clickeen.com" },
]

[vars]
BERLIN_BASE_URL = "https://berlin.dev.clickeen.com"
BERLIN_ISSUER = "https://berlin.dev.clickeen.com"
BERLIN_AUDIENCE = "clickeen.product"

[[kv_namespaces]]
binding = "USAGE_KV"
id = "a9396f7fee7f47bc9b1be520c78a24c9"
preview_id = "4d253b94b6b5434ab484cfe4a3a0fb9a"

[[r2_buckets]]
binding = "TOKYO_R2"
bucket_name = "tokyo-assets-dev"

[[queues.producers]]
binding = "L10N_PUBLISH_QUEUE"
queue = "instance-l10n-publish-cloud-dev"

[[queues.producers]]
binding = "RENDER_SNAPSHOT_QUEUE"
queue = "instance-render-snapshot-cloud-dev"

[[queues.consumers]]
queue = "instance-l10n-publish-cloud-dev"

[[queues.consumers]]
queue = "instance-render-snapshot-cloud-dev"

[env.local]
name = "tokyo-assets-local"
vars = { BERLIN_BASE_URL = "http://localhost:3005", BERLIN_ISSUER = "http://localhost:3005", BERLIN_AUDIENCE = "clickeen.product" }

[[env.local.kv_namespaces]]
binding = "USAGE_KV"
id = "00000000000000000000000000000000"
preview_id = "00000000000000000000000000000000"

[[env.local.r2_buckets]]
binding = "TOKYO_R2"
bucket_name = "tokyo-assets-dev"

[[env.local.queues.producers]]
binding = "L10N_PUBLISH_QUEUE"
queue = "instance-l10n-publish-local"

[[env.local.queues.producers]]
binding = "RENDER_SNAPSHOT_QUEUE"
queue = "instance-render-snapshot-local"

[[env.local.queues.consumers]]
queue = "instance-l10n-publish-local"

[[env.local.queues.consumers]]
queue = "instance-render-snapshot-local"

[triggers]
crons = ["0 3 * * *"]
